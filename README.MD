# ðŸ›¡ï¸ DGA Domain Detection (XGBoost)

> **PhÃ¡t hiá»‡n tÃªn miá»n Ä‘á»™c háº¡i sinh ra bá»Ÿi thuáº­t toÃ¡n (DGA - Domain Generation Algorithms) sá»­ dá»¥ng há»c mÃ¡y.**

Dá»± Ã¡n nÃ y xÃ¢y dá»±ng má»™t mÃ´ hÃ¬nh phÃ¡t hiá»‡n cÃ¡c tÃªn miá»n Ä‘Æ°á»£c sá»­ dá»¥ng bá»Ÿi cÃ¡c Botnet Ä‘á»ƒ káº¿t ná»‘i vá»›i C&C Server. MÃ´ hÃ¬nh trÃ­ch xuáº¥t **9 Ä‘áº·c trÆ°ng** káº¿t há»£p vá»›i thuáº­t toÃ¡n **XGBoost** Ä‘á»ƒ phÃ¢n loáº¡i tÃªn miá»n lÃ  **benign** hay **DGA**.

**Äá»™ chÃ­nh xÃ¡c hiá»‡n táº¡i:** `88.42%`

---

## ðŸ“‚ Cáº¥u trÃºc dá»± Ã¡n

```text
â”œâ”€â”€ dataset/                     # ThÆ° má»¥c chá»©a dá»¯ liá»‡u thÃ´ (UMUDGA & Tranco)
â”œâ”€â”€ 1_load.py                    # BÆ°á»›c 1: Load, lÃ m sáº¡ch vÃ  cÃ¢n báº±ng dá»¯ liá»‡u
â”œâ”€â”€ 2_feature_extration.py       # BÆ°á»›c 2: TrÃ­ch xuáº¥t 9 Ä‘áº·c trÆ°ng tá»« tÃªn miá»n
â”œâ”€â”€ 3_train_xgboost.py           # BÆ°á»›c 3: Huáº¥n luyá»‡n model
â”œâ”€â”€ 4_1_analyze.py               # BÆ°á»›c 4.1: PhÃ¢n tÃ­ch lá»—i
â”œâ”€â”€ 4_2_demo_model.py            # BÆ°á»›c 4.2: Demo kiá»ƒm tra tÃªn miá»n thá»i gian thá»±c
â”œâ”€â”€ feature_utils.py             # ThÆ° viá»‡n chá»©a cÃ¡c hÃ m tÃ­nh toÃ¡n Ä‘áº·c trÆ°ng
â”œâ”€â”€ google_10k_words.txt         # Tá»« Ä‘iá»ƒn há»— trá»£ tÃ­nh 'meaningful ratio'
â””â”€â”€ README.md                    # TÃ i liá»‡u dá»± Ã¡n
```
## Feature engineering
MÃ´ hÃ¬nh khÃ´ng Ä‘á»c chuá»—i kÃ½ tá»± (text) mÃ  phÃ¢n tÃ­ch dá»±a trÃªn 9 Ä‘áº·c trÆ°ng ngÃ´n ngá»¯ há»c Ä‘Æ°á»£c tÃ­nh toÃ¡n trong feature_utils.py:

- Shannon entropy: Äo Ä‘á»™ "há»—n loáº¡n" cá»§a chuá»—i kÃ½ tá»± (DGA thÆ°á»ng cÃ³ entropy cao).

- Meaningful word ratio: Tá»· lá»‡ tá»« cÃ³ nghÄ©a trong tÃªn miá»n (dá»±a trÃªn tá»« Ä‘iá»ƒn tiáº¿ng Anh 10k tá»«).

- Vowel ratio: Tá»· lá»‡ nguyÃªn Ã¢m (tÃªn miá»n sáº¡ch thÆ°á»ng dá»… Ä‘á»c -> nhiá»u nguyÃªn Ã¢m hÆ¡n).

- Digit ratio: Tá»· lá»‡ chá»¯ sá»‘.

- Length: Äá»™ dÃ i tÃªn miá»n.

- Max consonant sequence: Chuá»—i phá»¥ Ã¢m liÃªn tiáº¿p dÃ i nháº¥t.

- Hex character ratio: Tá»· lá»‡ kÃ½ tá»± hexa (a-f, 0-9).

- Max identical characters: KÃ½ tá»± láº·p láº¡i liÃªn tiáº¿p nhiá»u nháº¥t.

- Bigram ccore: Äiá»ƒm sá»‘ dá»±a trÃªn cÃ¡c cáº·p kÃ½ tá»± phá»• biáº¿n trong tiáº¿ng Anh (th, er, on, ...).


## ðŸš€ CÃ i Ä‘áº·t & sá»­ dá»¥ng

### 1. Prerequisites

CÃ i Ä‘áº·t cÃ¡c thÆ° viá»‡n cáº§n thiáº¿t:

```bash
pip install pandas numpy xgboost scikit-learn matplotlib seaborn tldextract joblib
```

### 2. Chuáº©n bá»‹ dá»¯ liá»‡u

Dá»± Ã¡n sá»­ dá»¥ng 2 nguá»“n dá»¯ liá»‡u chÃ­nh (Cáº§n táº£i vá» vÃ  Ä‘áº·t vÃ o folder `dataset`):

* **DGA:** [UMUDGA Dataset](https://www.google.com/search?q=https://umudga.inf.um.es/) (Äáº¡i há»c Murcia).
* **Benign:** [Tranco Top 1M](https://tranco-list.eu/).

### 3. Quy trÃ¬nh thá»±c hiá»‡n

**B1: Xá»­ lÃ½ dá»¯ liá»‡u thÃ´**
Tá»•ng há»£p dá»¯ liá»‡u tá»« 50 há» malware vÃ  top website sáº¡ch, lá»c bá» nhiá»…u (CDN, IP address).

```bash
python 1_load.py
```

*Output: `dataset_full.csv*`*

**B2: TrÃ­ch xuáº¥t Ä‘áº·c trÆ°ng**
Chuyá»ƒn Ä‘á»•i tÃªn miá»n thÃ nh cÃ¡c vector sá»‘ há»c.

```bash
python 2_feature_extration.py
```

*Output: `dataset_training_ready.csv*`

**B3: Huáº¥n luyá»‡n mÃ´ hÃ¬nh (Training)**
Cháº¡y thuáº­t toÃ¡n XGBoost vá»›i **RandomizedSearchCV** Ä‘á»ƒ tÃ¬m tham sá»‘ tá»‘i Æ°u.

```bash
python 3_train_xgboost.py
```

*Output: `dga_xgboost_model.pkl` vÃ  ma tráº­n nháº§m láº«n*

### 4. ÄÃ¡nh giÃ¡ & Demo

**PhÃ¢n tÃ­ch sai sá»‘:**
Xem xÃ©t cÃ¡c trÆ°á»ng há»£p model nháº­n diá»‡n sai Ä‘á»ƒ tinh chá»‰nh feature.

```bash
python 4_1_analyze.py
```

**Cháº¡y Demo (Live Test):**
Nháº­p tÃªn miá»n báº¥t ká»³ Ä‘á»ƒ kiá»ƒm tra káº¿t quáº£ dá»± Ä‘oÃ¡n.

```bash
python 4_2_demo_model.py
```

VÃ­ dá»¥ Demo:

```text
Nhap ten mien: google.com
-> [AN TOAN] Ten mien sach (Benign)

Nhap ten mien: aiybyuwbdyu.net
-> [CANH BAO] DGA MALWARE DETECTED!
```

## ðŸ“Š Káº¿t quáº£
![()\[confusion_matrix_xgboost.png\]](confusion_matrix_xgboost.png)
## ðŸ”® HÆ°á»›ng phÃ¡t triá»ƒn

- TÃ­ch há»£p vÃ o cÃ¡c giáº£i phÃ¡p nhÆ° IDS, IPS, Firewall hoáº·c SIEM
---
